# 5ì¥. ì„œë¹„ìŠ¤ ì¶”ìƒí™”




## ğŸ« Enum

* ìƒíƒœê°’ì„ ìœ„í•œ ìƒìˆ˜ë¥¼ ì‚¬ìš©í•  ê²½ìš°, ê°’ì˜ ìœ íš¨ì„±ì„ ê²€ì¦í•  ìˆ˜ ì—†ê³ , IDEì˜ ë„ì›€ì„ ë°›ì„ ìˆ˜ ì—†ë‹¤.

* ìœ„ì˜ ë¬¸ì œì ì„ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ë°”ë¡œ **Enum**ì´ë‹¤.

* **Enum** ì—­ì‹œ í´ë˜ìŠ¤ì´ë©°, ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì´ ìˆë‹¤.

    1. ìƒì„±ìëŠ” **private** ìœ¼ë¡œë§Œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

    1. Enumê°ì²´ëŠ” ê°ê°ì˜ **ìƒìˆ˜ê°’**ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

    1. Enumê°ì²´ëŠ” ì¸ë±ìŠ¤ ë²ˆí˜¸ë¥¼ ê°€ì§„ë‹¤.

* JAVA APIì—ì„œ ì§€ì›í•˜ëŠ” Enum ë©”ì„œë“œ

    1. **Enumëª….values()** : Enumì˜ ëª¨ë“  ìš”ì†Œë¥¼ ë°°ì—´(``Enumëª…[]``)ë¡œ ë°˜í™˜

    ```java
        enum Color {
            RED, GREEN, YELLOW;
        }
    ```

    ```java
        Color[] arr = Color.values();
    ```

    1. **Enumê°ì²´.ordinal()** : í•´ë‹¹ Enumê°ì²´ì˜ ì¸ë±ìŠ¤ê°’

    ```java
        Color myColor = Color.RED;
        System.out.println(myColor + "ì˜ ì¸ë±ìŠ¤ : " + myColor.ordinal());

        // REDì˜ ì¸ë±ìŠ¤ : 0
    ```

    1. **Enum.valueOf("enumëª…")** : ì¸ìì˜ enumì´ ì¡´ì¬í•œë‹¤ë©´, í•´ë‹¹ enumì˜ ë¬¸ìì—´ì„ ë°˜í™˜

    ```java
        System.out.println("ê²°ê³¼ : " + Color.valueOf("YELLOW"));

        // ê²°ê³¼ : YELLOW
    ```


>   ### ğŸ« Enum ë§Œë“¤ê¸°

* JAVA APIê°€ ì œê³µí•˜ëŠ” ë©”ì„œë“œê°€ ì•„ë‹Œ ì§ì ‘ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•

    ```java
        public enum Level {
            // ì†Œê´„í˜¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒìˆ˜ê°’ì„ ì§€ì •í•  ê²½ìš°ì—ëŠ”
            // enum ìƒì„±ìê°€ í•„ìˆ˜ì´ë‹¤. (privateìƒì„±ì)
            BASIC(1), SILVER(2), GOLD(3);

            private int value;

            // Enumì˜ ìƒì„±ìëŠ” private ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
            // ë˜í•œ ìƒì„±ìëŠ” ì»´íŒŒì¼ ì‹œì ì—ì„œ í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì—, privateìœ¼ë¡œ ìƒì„±í•´ì•¼ í•œë‹¤.
            private Level(int value) {
                this.value = value;
            }

            // enumê°ì²´ì˜ ìƒìˆ˜ê°’ GETTER
            public int getIntValue() {
                return this.value;
            }

            // ìƒìˆ˜ì— í•´ë‹¹í•˜ëŠ” enumê°ì²´ ê°€ì ¸ì˜¤ê¸° (static ë©”ì„œë“œ)
            public static Level valueOf(int value) {
                switch(value) {
                    case 1: return Level.BASIC;
                    case 2: return Level.SILVER;
                    case 3: return Level.GOLD;
                    default: throw new AssertionError("Unkown Value : " + value);
                }
            }
        }
    ```

* ìœ„ì˜ ì½”ë“œì—ì„œ enumìš”ì†Œë“¤ì— **ìƒìˆ˜ê°’**ì„ í• ë‹¹í•˜ê²Œ ë˜ë©´, ìƒìˆ˜ê°’ì˜ **íƒ€ì…**ì„ ì¸ìë¡œ ë°›ëŠ” **ìƒì„±ì**ë¥¼ í•„ìˆ˜ë¡œ ì‘ì„±í•´ì•¼ í•œë‹¤.

* Enumì€ ì»´íŒŒì¼ì‹œì ì—ì„œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì— ìƒì„±ìëŠ” **private**ì´ ë˜ê³ , í• ë‹¹ë˜ëŠ” ìƒìˆ˜ê°’ì˜ **íƒ€ì…**ì„ ë°›ëŠ” **ìƒì„±ì**ê°€ í•„ìš”í•˜ê²Œ ë˜ëŠ” ê²ƒì´ë‹¤.

* ìœ„ì˜ ì½”ë“œì—ì„œ Enumì˜ ì‚¬ìš©ì²˜ëŠ” ì´ 3ê°€ì§€ì´ë‹¤.

    1. POJOì—ì„œ ì§ê´€ì ì¸ ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

    ```java
        Level level = Level.GOLD;
        // ë³€ìˆ˜ levelì— ê³¨ë“œ(GOLD) enumì„ í• ë‹¹í•œë‹¤.
    ```

    1. POJO -> DBë¡œ ê°’ì„ ì €ì¥í•˜ê¸° ìœ„í•´ enumì—ì„œ ê°’ì„ ì¶”ì¶œí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

    ```java
        Level level = Level.GOLD;
        int intValue = level.getIntValue();
    ```

    1. DB -> POJOë¡œ ê°’ì„ ê°€ì ¸ì˜¬ ë•Œ, í•´ë‹¹ ê°’ì— ëŒ€í•œ enumê°’ì„ ì‹¤ìˆ˜ì—†ì´ ë³€í™˜í•  ìˆ˜ ìˆë‹¤.

    ```java
        int intLevel = resultSet.getInt("level");
        Level level = Level.valueOf(intLevel);
    ```

> ## ê°ì²´ì§€í–¥ ì—ì„œëŠ” ë°ì´í„°ë¥¼ ê°€ì§„ ê°ì²´ì—ê²Œ ì‘ì—…ì„ ìš”ì²­í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ì„±í•œë‹¤.

* ëŒ€ìƒ ê°ì²´ì—ê²Œ ë°ì´í„°ë¥¼ ìš”êµ¬í•˜ê²Œ í•˜ì§€ ë§ê³ , ëŒ€ìƒ ê°ì²´ì—ê²Œ ì‘ì—…ì„ ìš”ì²­í•˜ê²Œ ë§Œë“¤ì.


---


## ğŸ« íŠ¸ëœì­ì…˜

> ### ğŸ« íŠ¸ëœì­ì…˜ ì´ë€?

* ë”ì´ìƒ ë‚˜ëˆŒìˆ˜ ì—†ëŠ” **ë‹¨ìœ„ì‘ì—…** ì„ ë§í•œë‹¤.

* íŠ¸ëœì­ì…˜ì€ í•´ë‹¹ ì‘ì—…ì´ ì •ìƒ ì™„ë£Œë˜ë©´, **commit** ìœ¼ë¡œ ì‘ì—…ê²°ê³¼ë¥¼ í™•ì • ë° ë°˜ì˜í•œë‹¤.

* íŠ¸ëœì­ì…˜ì€ í•´ë‹¹ ì‘ì—…ì´ ë¹„ì •ìƒ ì™„ë£Œë˜ë©´, **rollback** ìœ¼ë¡œ ì‘ì—…ê²°ê³¼ë¥¼ ìˆ˜ì •ì „ ìƒíƒœë¡œ ë³µêµ¬í•œë‹¤.


---


> ### ğŸ« JDBCì˜ íŠ¸ëœì­ì…˜

* JDBCì—ì„œ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì€ **Connection** ê°ì²´ë¥¼ **ê°€ì ¸ì˜¤ê³ ** ì‚¬ìš©í•œ í›„ **ë‹«ëŠ”** ì‚¬ì´ì— ì¼ì–´ë‚œë‹¤.

* Connectionì˜ ê¸°ë³¸ ì„¤ì •ì€ **setAutoCommit(true)** ë¡œ ë˜ì–´ìˆê¸° ë•Œë¬¸ì—, ê°ê°ì˜ ì¿¼ë¦¬ë™ì‘ì— ê°ê°ì˜ íŠ¸ëœì­ì…˜ì´ ì„¤ì •ëœ ê²ƒì´ë‹¤.

* íŠ¸ëœì­ì…˜ì˜ ë²”ìœ„ ì§€ì •í•˜ëŠ” ê²ƒì„ **íŠ¸ëœì­ì…˜ ê²½ê³„ì„¤ì •** ì´ë¼ê³  í•œë‹¤.

* í•˜ë‚˜ì˜ Connection ì•ˆì—ì„œ ë§Œë“¤ì–´ì§€ëŠ” íŠ¸ëœì­ì…˜ì„ **ë¡œì»¬ íŠ¸ëœì­ì…˜** ì´ë¼ê³  í•œë‹¤.

* íŠ¸ëœì­ì…˜ ê²½ê³„ì„¤ì •ì„ í•˜ë ¤ë©´, **setAutoCommit(false)** ë¥¼ ì‚¬ìš©í•˜ì—¬, íŠ¸ëœì­ì…˜ì˜ ì‹œì‘ì§€ì ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

* íŠ¸ëœì­ì…˜ì´ ì •ìƒì™„ë£Œ ë˜ì—ˆë‹¤ë©´, **commit()** ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ëì§€ì ìœ¼ë¡œ ì¢…ë£Œí•  ìˆ˜ ìˆë‹¤.

* íŠ¸ëœì­ì…˜ì´ ë¹„ì •ìƒ ì™„ë£Œë˜ì—ˆë‹¤ë©´, **rollback()** ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ëì§€ì ìœ¼ë¡œ ì¢…ë£Œí•  ìˆ˜ ìˆë‹¤.

* ì‚¬ìš© ì˜ˆ

    ```java
        Connection conn = dataSource.getConnection();
        conn.setAutoCommit(false);

        try {
            PreparedStatement pstmt_1 = conn.prepareStatement("ì¿¼ë¦¬_1");
            pstmt_1.executeUpdate();

            PreparedStatement pstmt_2 = conn.prepareStatement("ì¿¼ë¦¬_2");
            pstmt_2.executeUpdate();

            conn.commit();

        } catch(SQLException e) {
            conn.rollback();

        } finally {
            pstmt_2.close();
            pstmt_1.close();
            conn.close();
        }
    ```


---


> ### ğŸ« ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ë™ê¸°í™”

* íŠ¸ëœì­ì…˜ì˜ ë™ê¸°í™”ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´, **DataSource** ê°ì²´ê°€ í•„ìš”í•˜ë‹¤.

* **TransactionSynchronizationManager** í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¸ëœì­ì…˜ì„ ë™ê¸°í™” í•  ìˆ˜ ìˆë‹¤.

* ë™ê¸°í™” ì‹œì‘ í›„, Connectionì€ **DataSourceUtils** í´ë˜ìŠ¤ë¥¼ í†µí•´ì„œ ê°€ì ¸ì™€ì•¼ í•œë‹¤.

* ë™ê¸°í™”ëœ Connectionì€ ìŠ¤í”„ë§ì˜ **Connection ì €ì¥ì†Œ**ì— ì €ì¥ë˜ì–´, ë™ê¸°í™”ë¥¼ í’€ ë•Œ ê¹Œì§€ ìœ ì§€ëœë‹¤.

* ë™ê¸°í™”ëœ Connectionì´ ì €ì¥ë˜ì–´ ìˆë‹¤ë©´, **JdbcTemplate**ì€ ì €ì¥ëœ Connectionì„ ì´ìš©í•œë‹¤.

* ë™ê¸°í™”ëœ Connectionì„ ì‚¬ìš©í•˜ëŠ” JdbcTemplateì€ íŠ¸ëœì­ì…˜ì„ ì¢…ë£Œí•˜ì§€ ì•Šê³ , ë¦¬ì†ŒìŠ¤ë„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤.

* íŠ¸ëœì­ì…˜ì˜ ì¢…ë£ŒëŠ” Connectionì˜ **commit()** ë˜ëŠ” **rollback()** ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.

* íŠ¸ëœì­ì…˜ ì¢…ë£Œ í›„, ë‹¤ìŒê³¼ ê°™ì€ ë§ˆë¬´ë¦¬ ì‘ì—…ì„ í•´ì•¼í•œë‹¤.

    1. Connectionë°˜í™˜ : **DataSourceUtils.releaseConnection(conn, dataSource);**

    1. DataSource ì–¸ë°”ì¸ë”© : **TransactionSynchronizationManager.unbindResource(dataSource);**

    1. Connection ì €ì¥ì†Œ ì‚­ì œ : **TransactionSynchronizationManager.clearSynchronization();**

* ì‚¬ìš© ì˜ˆ

    ```java
        public class MyBiz {
            private MyDao myDao;
            private DataSource dataSource;

            public void setDataSource(DataSource dataSource) {
                this.dataSource = dataSource;
            }

            public void setMyDao(MyDao myDao) {
                this.myDao = myDao;
            }            


            public void upgradeLevels() {
                // íŠ¸ëœì­ì…˜ ë™ê¸°í™” ì´ˆê¸°í™”
                TransactionSynchronizationManager.initSynchronization();

                // Connectionê°ì²´ ìƒì„± ë° íŠ¸ëœì­ì…˜ ë™ê¸°í™”ë¥¼ ìœ„í•œ dataSource ë°”ì¸ë”©
                Connection conn = DataSourceUtils.getConnection(dataSource);

                // íŠ¸ëœì­ì…˜ ì‹œì‘
                conn.setAutoCommit(false);

                try {
                    List<User> users = myDao.getAll();

                    for(User user : users) {
                        if(canUpgradeLevel(user)) {
                            upgradeLevel(user);
                        }
                    }

                    conn.commit();

                } catch(Exception e) {
                    conn.rollback();

                } finally {
                    // Connection ê°ì²´ ë°˜í™˜
                    DataSourceUtils.releaseConnection(conn);
                    
                    // DataSourceë¥¼ ì–¸ë°”ì¸ë”©
                    TransactionSynchronizationManager.unbindResource(dataSource);

                    // íŠ¸ëœì­ì…˜ ë™ê¸°í™” í•´ì œ
                    TransactionSynchronizationManager.clearSynchronization();
                }
            }
        }
    ```


---


> ### ğŸ« ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ì¶”ìƒí™”

* JDBC, JPA, JDO, í•˜ì´ë²„ë„¤ì´íŠ¸ ë“± íŠ¸ëœì­ì…˜ ê¸°ìˆ ë“¤ì— ëŒ€í•œ ì¶”ìƒí™” ì´ë‹¤.

* ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ì¶”ìƒí™”ëŠ” ê°ê°ì˜ íŠ¸ëœì­ì…˜ ê¸°ìˆ ë“¤ì— ëŒ€í•´ ì˜ì¡´ì„±ì„ ì œê±°í•˜ë„ë¡ ë§Œë“¤ì–´ ì¤€ë‹¤.

* ì¦‰, ìŠ¤í”„ë§ì˜ íŠ¸ëœì­ì…˜ ì¶”ìƒí™”ë¥¼ ì‚¬ìš©í•  ê²½ìš°, íŠ¸ëœì­ì…˜ ê¸°ìˆ ë“¤ì— ëŒ€í•´ ë…ë¦½ì ì´ ëœë‹¤.

* ì‚¬ìš©ë²•

    ```java
        public class MyBiz {
            private MyDao myDao;
            private DataSource dataSource;

            public void setDataSource(DataSource dataSource) {
                this.dataSource = dataSource;
            }

            public void setMyDao(MyDao myDao) {
                this.myDao = myDao;
            }


            public void upgradeLevels() {
                // íŠ¸ëœì­ì…˜ ê´€ë¦¬ì ê°ì²´ ìƒì„±
                PlatformTransactionManager transactionManager = new DataSourceManager(dataSource);

                // íŠ¸ëœì­ì…˜ì˜ ìƒíƒœê°’ë“¤ì„ ê°€ì§„ ê°ì²´ ìƒì„± (íŠ¸ëœì­ì…˜ ëª…ë ¹ì— ì‚¬ìš©)
                // getTransaction()ì„ í˜¸ì¶œí•˜ë©´, íŠ¸ëœì­ì…˜ì´ ì‹œì‘ëœë‹¤. (ë™ê¸°í™”ëœ Connectionì´ ì €ì¥ì†Œì— ì €ì¥ëœë‹¤)
                // ì´ ë•Œë¶€í„° JdbcTemplateì€ ì €ì¥ì†Œì— ì €ì¥ëœ Connectionì„ ì´ìš©í•˜ê²Œ ë˜ë©°, ë™ì¼í•œ íŠ¸ëœì­ì…˜ì— ì†í•˜ê²Œ ëœë‹¤.
                TransactionStatus status = transactionManager.getTransaction(new DefaultTransactionDefinition());

                try {
                    List<User> users = myDao.getAll();

                    for(User user : users) {
                        if(canUpgradeLevel(user)) {
                            upgradeLevel(user);
                        }
                    }

                    transactionManager.commit(status);

                } catch(RuntimeException e) {
                    transactionManager.rollback(status);
                    throw e;
                }
            }
    ```    

* ìŠ¤í”„ë§ì˜ **PlatformTransactionManager** êµ¬í˜„ ê°ì²´ëŠ” ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì˜ ë¹ˆ(Bean)ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. (ì‹±ê¸€í†¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬)


---


## ğŸ« ë©”ì¼ ì„œë¹„ìŠ¤ ì¶”ìƒí™” (JavaMail)

* javax.mail.jar ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”


---


## ğŸ« í…ŒìŠ¤íŠ¸ ëŒ€ì—­

* **í…ŒìŠ¤íŠ¸ ëŒ€ì—­** : í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì˜ì¡´í•˜ëŠ” ê°ì²´ë¥¼ **ëŒ€ì²´í•  ìˆ˜ ìˆë„ë¡ ë§Œë“  ê°ì²´**ë¥¼ ë§í•œë‹¤.

* **í…ŒìŠ¤íŠ¸ ìŠ¤í…(Test Stub)** : í…ŒìŠ¤íŠ¸ ëŒ€ìƒì´ ì›í• í•œ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì—­í• ì„ í•œë‹¤.

* **ëª© ì˜¤ë¸Œì íŠ¸** : í…ŒìŠ¤íŠ¸ ìŠ¤í…ì˜ ê¸°ëŠ¥ì— ì¶”ê°€ë¡œ, í…ŒìŠ¤íŠ¸ ëŒ€ìƒìœ¼ë¡œë¶€í„° ì „ë‹¬ë°›ì€ ë°ì´í„°ë¥¼ ê²€ì¦í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ëœ ê°ì²´ë¥¼ ë§í•œë‹¤. (ì „ë‹¬ë°›ì€ ë°ì´í„°ë¥¼ í•„ë“œë³€ìˆ˜ì— ì €ì¥)